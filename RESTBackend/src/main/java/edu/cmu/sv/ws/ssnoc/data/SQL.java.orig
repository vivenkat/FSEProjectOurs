package edu.cmu.sv.ws.ssnoc.data;

/**
 * This class contains all the SQL related code that is used by the project.
 * Note that queries are grouped by their purpose and table associations for
 * easy maintenance.
 *
 */
public class SQL {
<<<<<<< HEAD
    /*
     * List the USERS table name, and list all queries related to this table
     * here.
     */
    public static final String SSN_USERS = "SSN_USERS";
=======
	/*
	 * List the USERS table name, and list all queries related to this table
	 * here.
	 */
	public static final String SSN_USERS = "SSN_USERS";
>>>>>>> afd9b4dbe8cadae2a7e1f748d59be347199a36f9
	/*public static final String USERS_MESSAGES = "USERS_MESSAGES";*/

    /**
     * Query to check if a given table exists in the H2 database.
     */
    public static final String CHECK_TABLE_EXISTS_IN_DB = "SELECT count(1) as rowCount "
            + " FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_SCHEMA = SCHEMA() "
            + " AND UPPER(TABLE_NAME) = UPPER(?)";

<<<<<<< HEAD
    // ****************************************************************
    // All queries related to USERS
    // ****************************************************************
    /**
     * Query to create the USERS table.
     */


//	CREATE TABLE user (
//			uid integer NOT NULL,
//			username varchar(255) NOT NULL,
//			password varchar(40) NOT NULL,
//			online_status smallint NOT NULL,
//			role varchar(255) NOT NULL,
//			emergency_status smallint NOT NULL,
//			PRIMARY KEY (uid),
//	);
//
//	CREATE TABLE messages (
//			pid integer NOT NULL,
//			message varchar(255) NOT NULL,
//			uid integer NOT NULL,
//			timestamp timestamp NOT NULL,
//			PRIMARY KEY (pid),
//			FORIEGN KEY (uid) REFERENCES user(uid)
//	);
//
//	CREATE TABLE emergency_status (
//			ok smallint,
//			help smallint,
//			emergency smallint,
//			underfined smallint,
//			FORIEGN KEY (uid) REFERENCES user(uid)
//	);


    public static final String CREATE_USERS = "create table IF NOT EXISTS " + SSN_USERS +
            "(user_id IDENTITY PRIMARY KEY," +
            "user_name VARCHAR(255) NOT NULL," +
            "password varchar(40) NOT NULL,"+
            "online_status smallint ,"+
            "emergency_status smallint ,"+
            "salt VARCHAR(512)  );";

//	public static final String CREATE_USERS = "create table IF NOT EXISTS "
//			+ SSN_USERS + " ( user_id IDENTITY PRIMARY KEY,"
//			/*+ " first_name VARCHAR(100),"+ " last_name VARCHAR(100),"*/
//			+ " user_name VARCHAR(100),"+ " password VARCHAR(512),"
//			/*+ " online_status TINYINT(1),"+ " role VARCHAR(100),"
//			+ " location VARCHAR(100)," */+" salt VARCHAR(512) )";
=======
	// ****************************************************************
	// All queries related to USERS
	// ****************************************************************
	/**
	 * Query to create the USERS table.
	 */
	public static final String CREATE_USERS = "create table IF NOT EXISTS "
			+ SSN_USERS + " ( user_id IDENTITY PRIMARY KEY,"
			/*+ " first_name VARCHAR(100),"+ " last_name VARCHAR(100),"*/
			+ " user_name VARCHAR(100),"+ " password VARCHAR(512),"
			/*+ " online_status TINYINT(1),"+ " role VARCHAR(100),"
			+ " location VARCHAR(100)," */+" salt VARCHAR(512) )";
>>>>>>> afd9b4dbe8cadae2a7e1f748d59be347199a36f9


	/*public static final String CREATE_MESSAGES = "create table IF NOT EXISTS "
			+ USERS_MESSAGES + " ( user_id int FOREIGN KEY REFERENCES SSN_USERS(user_id), "
			+ " pid IDENTITY PRIMARY KEY," + "message VARCHAR(255),"
			+ " timestamp TIMESTAMP(8)"; */
<<<<<<< HEAD

    /**
     * Query to load all users in the system.
     */
    public static final String FIND_ALL_USERS = "select user_id, user_name, password,"
            + " online_status," + " emergency_status," + " salt " + " from " + SSN_USERS + " order by user_name";
=======
>>>>>>> afd9b4dbe8cadae2a7e1f748d59be347199a36f9

    /**
     * Query to find a user details depending on his name. Note that this query
     * does a case insensitive search with the user name.
     */
    public static final String FIND_USER_BY_NAME = "select user_id, user_name, password,"
            + " online_status, "
            + " emergency_status,"
            + " salt "
            + " from "
            + SSN_USERS
            + " where UPPER(user_name) = UPPER(?)";

    public static final String FIND_STATUS_BY_NAME = "select emergency_status from SSN_USERS where UPPER(user_name) = UPPER(?)";

    /**
     * Query to insert a row into the users table.
     */
    public static final String INSERT_USER = "insert into " + SSN_USERS
            + " (user_name, password, online_status, emergency_status, salt) values (?, ?, 0, 1, ?)";

}
